<!-- Top Buttons -->
<div class="d-flex align-items-center mb-3 position-relative">
  <button class="btn btn-primary me-2" (click)="addNewContainer()">Add Container</button>
  <button class="btn btn-secondary" (click)="openNewPageModal()" #addPageBtn>Add Page</button>
</div>

<!-- Tooltip for new users -->
<div *ngIf="showTooltip" class="tooltip-custom">
  Click a breadcrumb to edit page settings
</div>

<!-- Breadcrumb Navigation -->
<div class="breadcrumb-bar" *ngIf="pages.length">
  <ng-container *ngFor="let page of pages; let i = index">
    <span
      class="breadcrumb"
      [class.active]="page === selectedPage"
      [class.highlight]="page === highlightedPage"
      (click)="openPageSettingsModal(page)"
    >
      {{ page.name }}
    </span>
    <span *ngIf="i < pages.length - 1"> / </span>
  </ng-container>
</div>

<!-- Canvas -->
<div class="canvas" *ngIf="selectedPage">
  <h3>{{ selectedPage.name }}</h3>
  <div
    cdkDropList
    class="component-list"
    [cdkDropListData]="selectedPage.components"
    [cdkDropListConnectedTo]="getConnectedLists()"
    (cdkDropListDropped)="drop($event)"
  >
    <div
      class="component"
      *ngFor="let comp of selectedPage.components"
      cdkDrag
      (click)="selectComponent(comp); $event.stopPropagation()"
    >
      {{ comp.type }} - {{ comp.value || comp.text || 'Component' }}
    </div>
  </div>
</div>

<!-- Draggable Modal -->
<div
  *ngIf="showModal"
  class="properties-panel card shadow-lg"
  cdkDrag
  cdkDragRootElement=".properties-panel"
  [ngStyle]="modalPosition"
>
  <div class="panel-header d-flex justify-content-between align-items-center" cdkDragHandle>
    <h6 class="mb-0">{{ isSettingsMode ? 'Page Settings' : 'New Page' }}</h6>
    <button class="close-btn" (click)="closeModal()">&times;</button>
  </div>

  <div class="panel-body">
    <!-- New Page Mode -->
    <div *ngIf="!isSettingsMode">
      <label>Page Name</label>
      <input
  type="text"
  class="form-control"
  [(ngModel)]="newPageName"
  placeholder="Enter page name"
  (keyup.enter)="createPageOnEnter($event)"
/>


    </div>

    <!-- Page Settings Mode -->
    <div *ngIf="isSettingsMode">
      <ul class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center" (click)="renamePage(selectedPage)">
          ✏️ Rename
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center" (click)="duplicatePage(selectedPage)">
          📑 Duplicate
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center text-danger" (click)="deletePage(selectedPage)">
          🗑 Delete
        </li>
      </ul>
    </div>
  </div>

  <div class="panel-footer d-flex justify-content-end gap-2">
    <button class="btn btn-secondary btn-sm" (click)="closeModal()">Cancel</button>
    <button
      *ngIf="!isSettingsMode"
      class="btn btn-success btn-sm"
      [disabled]="!newPageName.trim()"
      (click)="createPage()"
    >
      Create
    </button>
  </div>
</div>
